# CentrAuth
Documentation of the Centralized Authentication Server of the iden3 system.


## Usage
In the `go-iden3/cmd/centrauth` directory, run:
```
go run main.go --config path-to-config/config.yaml start
```

Also can be build using:
```
go build
```

And then execute:
```
./centrauth
```


## API Endpoints

### GET /ws/:id
Called from the website, when the webpage is loaded, to perform a WebSocket connection with the backend.

### POST /auth
Called from the Wallet App, once the `AuthorizeKSignClaim` authorizig the `KSign` key that the website have generated is performed.

Input:
```js
{
  address: '0x970e8128ab834e8eac17ab8e3812f010678cf791',
  challenge: 'uuid-1538423206-n5kcfb',
  signature: '0x55cd8362255e3b679f6287d4cc83a611ca7dd5e6858688565fd2c04b8bee9f295a88bb3b1eea442dd0fd0f96c045968b0f68dc211fdf146209b447884f6c27351c',
  ksign: '0xf387b66096096cdbeb6a86824c767dced53f9e6c',
  ksignProof: {
    ClaimProof: {
      Leaf: '0x3cfc3a1edbf691316fec9b75970fbfb2b0e8d8edfc6ec7628db77c4969403074353f867ef725411de05e3d4b0a01c37cf7ad24bcc213141a0000005400000000f387b66096096cdbeb6a86824c767dced53f9e6c2077bb3f0400dd62421c97220536fd6ed2be29228e8db1315e8c6d7525f4bdf4dad9966a2e7371f0a24b1929ed765c0e7a3f2b4665a76a19d58173308bb34062000000005bb279a6000000005bb279a6',
      Hi: '0xd589b005bca14f7dc7527b2e10d096bd094bd711269dce41044bf80aa2b576a3',
      Proof: '0x000000000000000000000000000000000000000000000000000000000000015fff061391de3c52d26f6a1134a61e04e69a3856377a7ea3b1a3d3dc8fb98b2160052a64b00e22bbd2de0f8f1d59af615c736f83847daa9cafdae6b1816cd78e156d161b00cc8ff09563164edbf7bed0bedfe6467d80557cd316a5418c5b37eccc4ea6a62f13e065ec41f06798521fad80b39eaf4d0afe8c6cbe4e58be047c12d4c5cf45b9ef5855034e8b0a208ceb3dd191ac571c2d349f4fa72594048e3cf97df8e0c8f5c1574e25c4bb33ff6bba2409bb5fd8be3b959bd3054eb6b379059faa1849c108d4f33fb8a1805e1a5a8ab48711f90b58d61fa69807a387405ab78c3f',
      Root: '0x646b1fae1afdd5bf7ce1a86eadfda7927a99a4a660131848e7c7d68e93d0c4d6'
    },
    SetRootClaimProof: {
      Leaf: '0x3cfc3a1edbf691316fec9b75970fbfb2b0e8d8edfc6ec7628db77c49694030749b9a76a0132a0814192c05c9321efc30c7286f6187f18fc6000000540000002d970e8128ab834e8eac17ab8e3812f010678cf791646b1fae1afdd5bf7ce1a86eadfda7927a99a4a660131848e7c7d68e93d0c4d6',
      Hi: '0xb4c193b47aceeccbedadd082c8817cc4c09fdee830357ca6cb4fbc0917bea771',
      Proof: '0x00000000000000000000000000000000000000000000000000000000000000bf670ad13fd3dbcef098045b9db71a4af9842c921e05f8fbd673ba79b2064e8e9a870b5061e8ac6a22a01c9456bef562c63ec50cea0684c3eba2a57f90d2ea3b6fa432a8ba3c651eac4d170547bf9ee951ba0a0ddc98c612bab4a30620cd6085c7a6510ae38213551b762006ad10339736d4bec8566bc078985879df5c28b780befeddb1c66bcfdfa0725e007e1a37f181b1504cab8ffced7a9ec59bedb90088c032a12f72131c66a3906ab06e19484a78603c07b6b3e8680af6a06e2277737ce65464b3c62aa3a0a5f68a98b009d12e950858cfa1ce3d2b726b82dff3bd247cc3',
      Root: '0xfb8ae9b8633535336e6d194efaa8439362889856b8140ad7ec7b8971df0784af'
    },
    ClaimNonRevocationProof: {
      Leaf: '0x0000000000000000000000000000000000000000000000000000000000000000',
      Hi: '0x9d082e241f55d6a92222988e20b9b6e3b47a826c32d994a8d2966ee76665acce',
      Proof: '0x000000000000000000000000000000000000000000000000000000000000003f179bf79cd28e4eb5690a8a970b900ef7cca2fdee490eff780b35b89fb83c0c656e396ad0ec5a21a7ca3a9c86a62600e79f18e8c324b896503127f3723415fc7debbf3639293707d8d97227ee6f5d57a26e57489c0d4a0a991d77c6b0a0d895f33451e493ce3a82253335919413362004a8bc2a861e09914e9e96f0ddd10b7246256054b021561f37addbee4fc314b3f1121fc384f6465ff0869504005b1e67e0f9b8cb581266f0edd794aa8b890a5ce49a6a9991bcb93785eae702f620e2cedb',
      Root: '0x646b1fae1afdd5bf7ce1a86eadfda7927a99a4a660131848e7c7d68e93d0c4d6'
    },
    SetRootClaimNonRevocationProof: {
      Leaf: '0x0000000000000000000000000000000000000000000000000000000000000000',
      Hi: '0x09480abffb5a6191271204dc9f1b2b558ef0df591c2505fc917ad4f5279e72ad',
      Proof: '0x00000000000000000000000000000000000000000000000000000000000000470dec9808aaafc9d48450ec224428c0e227e9893810c88e72a3a05e15053ba5fe4c7962a940316f33fcaf11b7405f3b32ad637732ffa2a04bb29f7ef317e73c1032a12f72131c66a3906ab06e19484a78603c07b6b3e8680af6a06e2277737ce65464b3c62aa3a0a5f68a98b009d12e950858cfa1ce3d2b726b82dff3bd247cc3',
      Root: '0xfb8ae9b8633535336e6d194efaa8439362889856b8140ad7ec7b8971df0784af'
    }
  }
}
```

Returns:
```js
{
  success: true,
  token: 'cCI6IkpXVCJ...asdf'
}
```
